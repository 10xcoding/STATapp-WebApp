<mvc:View
    id="ticketListView"
    controllerName="statapp.controller.ticket.TicketList"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc">
    
    <Page id="ticketListPage" title="{i18n>TicketList.Title}"
		showNavButton="true"
		navButtonPress="onNavBack"
		class="sapUiResponsiveContentPadding" >
		<subHeader>
            <Toolbar>
                <SearchField
                    liveChange="onFilterTickets"/>
            </Toolbar>
        </subHeader>
        <ScrollContainer vertical="true" getParent="true">
            <layoutData>
                <FlexItemData growFactor="1"/>
            </layoutData>
            <List
                id="ticketsList"
                items="{
                    path: '/Tickets',
                    filters: [{
                        path: 'ticketStatus_description',
                        operator: 'NE',
                        value1: 'Closed'
                    }],
                    sort: 'dateCreated'
                }">
                <items> 
                    <CustomListItem
                        type="Active"
                        press="onTicketListItemPress">
                        <HBox
                            alignItems="Start"
                            justifyContent="SpaceBetween">
                            <items>
                                <FlexBox>
                                    <items>
                                        <core:Icon
                                            size="2rem"
                                            src="{
                                                parts:[{
                                                    path:'functionalArea_description'
                                                }],
                                                formatter: '.formatter.getFuncAreaIcon'
                                            }"
                                            class="sapUiSmallMarginBegin
                                            sapUiSmallMarginTopBottom" />
                                        <VBox class="sapUiSmallMarginBegin sapUiSmallMarginTopBottom" >
                                            <Title text="{ticketTitle}"/>
                                            <Label text="{i18n>Ticket.Creator}: {creator_firstName} {creator_lastName}" />
                                            <Label text="{i18n>Ticket.Assignee}: {assignee_firstName} {assignee_lastName}" />
                                        </VBox>
                                    </items>
                                </FlexBox>
                                <VBox class="sapUiSmallMarginEnd sapUiSmallMarginTopBottom"
                                    alignItems="End"
                                    justifyContent="End"
                                    width="200px">
                                    <items class="sapUiSmallMarginEnd">
                                        <Title text="{ticketStatus_description}" />
                                        <ObjectStatus
                                            text="{ticketPriority_description}"
                                            state="{
                                                parts:[{
                                                    path:'ticketPriority_description'
                                                }],
                                                formatter: '.formatter.getPriorityState'
                                            }"
                                        />
                                    </items>
                                </VBox>
                            </items>
                        </HBox>
                    </CustomListItem>
                </items>
            </List>
        </ScrollContainer>
        <footer>
			<OverflowToolbar id="TicketListFooter">
                <ToolbarSpacer/>
                <Button id="newTicketButton" text="{i18n>TicketList.NewTicketButton}" press="onNavToNewTicket" icon="sap-icon://add"/>
            </OverflowToolbar>
        </footer>
    </Page>
</mvc:View>